# ============================================================================
# Real-Time Collaboration System - Environment Configuration
# ============================================================================
#
# Phase 5: Security Hardening - Production Configuration
#
# IMPORTANT: 
# - Copy this file to .env.collaboration
# - Replace all example values with secure, randomly generated values
# - Never commit .env.collaboration to version control
# - Rotate secrets regularly (every 90 days recommended)
#
# Security Notes:
# - All secrets should be at least 32 characters
# - Use cryptographically secure random generation
# - Store production secrets in AWS Secrets Manager or HashiCorp Vault
#
# ============================================================================

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# WebSocket Server
WEBSOCKET_HOST=0.0.0.0
WEBSOCKET_PORT=3000
WEBSOCKET_PATH=/collaboration

# IMPORTANT: Set to 'production' in production environments
NODE_ENV=development

# ============================================================================
# AUTHENTICATION & JWT (Phase 5 Enhanced)
# ============================================================================

# JWT Access Token Secret (REQUIRED)
# Generate: node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
# Minimum 256 bits (32 bytes), rotate every 90 days
JWT_SECRET=CHANGE_ME_TO_SECURE_RANDOM_STRING_MIN_256_BITS

# JWT Refresh Token Secret (REQUIRED)
# Must be different from JWT_SECRET
JWT_REFRESH_SECRET=CHANGE_ME_TO_DIFFERENT_SECURE_RANDOM_STRING

# JWT Token Expiration
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# JWT Issuer and Audience
JWT_ISSUER=collaboration-system
JWT_AUDIENCE=collaboration-clients

# ============================================================================
# ENCRYPTION (Phase 5)
# ============================================================================

# Master Encryption Key (REQUIRED)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# Must be exactly 256 bits (32 bytes) base64 encoded
# Rotate every 90 days
ENCRYPTION_KEY=CHANGE_ME_TO_SECURE_BASE64_256_BIT_KEY

# Encryption Algorithm (DO NOT CHANGE unless you know what you're doing)
ENCRYPTION_ALGORITHM=aes-256-gcm

# Enable automatic key rotation
ENCRYPTION_ENABLE_ROTATION=true
ENCRYPTION_ROTATION_DAYS=90

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL Connection
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=collaboration
DATABASE_USER=collaboration_user
DATABASE_PASSWORD=CHANGE_ME_TO_SECURE_PASSWORD
DATABASE_SSL=true
DATABASE_MAX_CONNECTIONS=20

# Database Connection String (alternative to individual settings)
# DATABASE_URL=postgresql://user:password@host:port/database?sslmode=require

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

# Redis Connection
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_TO_SECURE_REDIS_PASSWORD
REDIS_DB=0
REDIS_KEY_PREFIX=collab:

# Redis TLS/SSL
REDIS_TLS=false

# Redis Connection String (alternative)
# REDIS_URL=redis://:password@host:port/0

# ============================================================================
# RATE LIMITING (Phase 5)
# ============================================================================

# Default Rate Limits (requests per window)
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_WINDOW_MS=60000

# Role-Based Limits
RATE_LIMIT_ADMIN=1000
RATE_LIMIT_OPERATOR=500
RATE_LIMIT_ANALYST=200
RATE_LIMIT_VIEWER=100

# Operation-Specific Limits
RATE_LIMIT_MESSAGE=60
RATE_LIMIT_COMMENT_CREATE=30
RATE_LIMIT_COMMENT_EDIT=20
RATE_LIMIT_COMMENT_DELETE=10
RATE_LIMIT_SESSION_CREATE=5
RATE_LIMIT_HEARTBEAT=120

# IP-Based Limiting
RATE_LIMIT_IP=300
RATE_LIMIT_IP_WINDOW_MS=60000

# Ban Configuration
RATE_LIMIT_MAX_VIOLATIONS=5
RATE_LIMIT_BAN_DURATION_MS=3600000
RATE_LIMIT_VIOLATION_DECAY_MS=300000

# Exponential Backoff
RATE_LIMIT_ENABLE_BACKOFF=true
RATE_LIMIT_BACKOFF_MULTIPLIER=2
RATE_LIMIT_MAX_BACKOFF_MS=300000

# ============================================================================
# SECURITY HEADERS (Phase 5)
# ============================================================================

# Content Security Policy
CSP_ENABLED=true
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: https:
CSP_CONNECT_SRC='self'
CSP_FONT_SRC='self'
CSP_OBJECT_SRC='none'
CSP_MEDIA_SRC='self'
CSP_FRAME_SRC='none'
CSP_UPGRADE_INSECURE_REQUESTS=true
CSP_BLOCK_ALL_MIXED_CONTENT=true

# HTTP Strict Transport Security (HSTS)
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# X-Frame-Options
X_FRAME_OPTIONS=DENY

# X-Content-Type-Options
X_CONTENT_TYPE_OPTIONS=nosniff

# X-XSS-Protection (legacy browsers)
X_XSS_PROTECTION=1; mode=block

# Referrer-Policy
REFERRER_POLICY=strict-origin-when-cross-origin

# ============================================================================
# CORS CONFIGURATION (Phase 5)
# ============================================================================

# CORS Origin (comma-separated list or 'false' to disable)
# In production, specify exact origins
CORS_ORIGIN=http://localhost:3000,http://localhost:8080
# CORS_ORIGIN=https://yourdomain.com,https://app.yourdomain.com

# CORS Methods
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS

# CORS Headers
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With
CORS_EXPOSED_HEADERS=X-RateLimit-Limit,X-RateLimit-Remaining,X-RateLimit-Reset

# CORS Credentials
CORS_CREDENTIALS=true

# CORS Max Age (seconds)
CORS_MAX_AGE=86400

# ============================================================================
# AUDIT LOGGING (Phase 5)
# ============================================================================

# Enable Audit Logging
AUDIT_LOGGING_ENABLED=true

# Log Destinations
AUDIT_LOG_TO_DATABASE=true
AUDIT_LOG_TO_FILE=true
AUDIT_LOG_TO_CONSOLE=true

# File Logging
AUDIT_LOG_DIRECTORY=./logs/audit
AUDIT_LOG_ROTATION_SIZE_MB=100
AUDIT_LOG_RETENTION_DAYS=90

# SIEM Integration (optional)
AUDIT_SIEM_ENABLED=false
AUDIT_SIEM_ENDPOINT=https://siem.example.com/api/logs
AUDIT_SIEM_API_KEY=

# Data Masking
AUDIT_MASK_SENSITIVE_DATA=true
AUDIT_SENSITIVE_FIELDS=password,token,secret,apiKey,creditCard

# ============================================================================
# INPUT VALIDATION (Phase 5)
# ============================================================================

# String Limits
VALIDATION_MAX_STRING_LENGTH=10000
VALIDATION_MAX_ARRAY_LENGTH=1000
VALIDATION_MAX_OBJECT_DEPTH=10
VALIDATION_MAX_URL_LENGTH=2048

# Allowed Protocols
VALIDATION_ALLOWED_PROTOCOLS=http,https,ws,wss

# Allowed File Extensions
VALIDATION_ALLOWED_FILE_EXTENSIONS=.txt,.md,.json,.csv,.pdf,.doc,.docx

# ============================================================================
# SECRETS MANAGEMENT (Phase 5)
# ============================================================================

# Secrets Source Priority: env > aws > vault
SECRETS_SOURCE_ENV=true

# AWS Secrets Manager (optional)
SECRETS_AWS_ENABLED=false
SECRETS_AWS_REGION=us-east-1
SECRETS_AWS_SECRET_PREFIX=collaboration/

# HashiCorp Vault (optional)
SECRETS_VAULT_ENABLED=false
SECRETS_VAULT_ADDRESS=https://vault.example.com
SECRETS_VAULT_TOKEN=
SECRETS_VAULT_PATH=secret/collaboration

# Secrets Validation
SECRETS_FAIL_ON_MISSING_REQUIRED=true
SECRETS_WARN_ON_MISSING_OPTIONAL=true

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================

# Session Timeout (milliseconds)
SESSION_TIMEOUT=300000
SESSION_HEARTBEAT_INTERVAL=30000

# Maximum Concurrent Sessions per User
MAX_CONCURRENT_SESSIONS=5

# Session Fixation Prevention
SESSION_REGENERATE_ON_AUTH=true

# ============================================================================
# MONITORING & METRICS
# ============================================================================

# Enable Metrics
METRICS_ENABLED=true

# Metrics Export
METRICS_EXPORT_INTERVAL=60000

# Health Check Endpoint
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# ============================================================================
# LOGGING
# ============================================================================

# Log Level (debug, info, warn, error)
LOG_LEVEL=info

# Log Format (json, text)
LOG_FORMAT=json

# Log Destination
LOG_TO_FILE=true
LOG_TO_CONSOLE=true
LOG_DIRECTORY=./logs

# ============================================================================
# SECURITY MONITORING (Phase 5)
# ============================================================================

# Enable Security Monitoring
SECURITY_MONITORING_ENABLED=true

# Brute Force Detection
SECURITY_BRUTE_FORCE_THRESHOLD=10
SECURITY_BRUTE_FORCE_WINDOW_MS=300000

# Suspicious Activity Detection
SECURITY_DETECT_ABNORMAL_PATTERNS=true
SECURITY_PATTERN_THRESHOLD=5

# Automated Response
SECURITY_AUTO_BAN_ENABLED=true
SECURITY_AUTO_BAN_DURATION_MS=3600000

# Real-time Alerts
SECURITY_ALERTS_ENABLED=true
SECURITY_ALERT_EMAIL=security@example.com
SECURITY_ALERT_WEBHOOK=

# Integration with External Monitoring
SECURITY_CLOUDWATCH_ENABLED=false
SECURITY_DATADOG_ENABLED=false

# ============================================================================
# DEVELOPMENT & TESTING
# ============================================================================

# Enable Debug Mode (DO NOT enable in production)
DEBUG_MODE=false

# Bypass Security Checks (DO NOT enable in production)
BYPASS_RATE_LIMITING=false
BYPASS_AUTHENTICATION=false
BYPASS_AUTHORIZATION=false

# Mock External Services
MOCK_AWS_SERVICES=false
MOCK_REDIS=false

# ============================================================================
# OPTIONAL INTEGRATIONS
# ============================================================================

# AWS Configuration
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# AWS KMS (for encryption key management)
AWS_KMS_KEY_ID=

# Slack Notifications
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#security-alerts

# Email Notifications
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@example.com

# ============================================================================
# COMPLIANCE & GDPR
# ============================================================================

# Enable GDPR Features
GDPR_ENABLED=true
GDPR_DATA_RETENTION_DAYS=365
GDPR_ALLOW_DATA_EXPORT=true
GDPR_ALLOW_DATA_DELETION=true

# Data Processing Agreement
DPA_ENABLED=false
DPA_PROCESSOR_NAME=Your Organization
DPA_PROCESSOR_CONTACT=dpo@example.com

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Connection Pool Sizes
DB_POOL_MIN=2
DB_POOL_MAX=20

# Redis Pool
REDIS_POOL_MIN=2
REDIS_POOL_MAX=10

# WebSocket Limits
WS_MAX_PAYLOAD_SIZE=1048576
WS_MAX_CONNECTIONS=1000
WS_PING_INTERVAL=30000
WS_PING_TIMEOUT=5000

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Phase 5 Features
FEATURE_INPUT_VALIDATION=true
FEATURE_RATE_LIMITING=true
FEATURE_ENCRYPTION=true
FEATURE_AUDIT_LOGGING=true
FEATURE_SECURITY_HEADERS=true
FEATURE_CSRF_PROTECTION=true
FEATURE_SECURITY_MONITORING=true

# Additional Features
FEATURE_MFA=false
FEATURE_PASSWORDLESS=false
FEATURE_SSO=false

# ============================================================================
# END OF CONFIGURATION
# ============================================================================

#
# Generated on: 2024-01-01
# Version: 1.0.0 (Phase 5 - Security Hardening)
#
# For support and documentation, visit:
# https://github.com/yourorg/collaboration-system
#